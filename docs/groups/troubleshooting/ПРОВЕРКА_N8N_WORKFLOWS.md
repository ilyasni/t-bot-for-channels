# üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ n8n workflows - –†–µ—à–µ–Ω–∏–µ 500 –æ—à–∏–±–∫–∏

**–î–∞—Ç–∞:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** n8n –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500 –æ—à–∏–±–∫—É, –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## üêõ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

**–õ–æ–≥–∏ –±–æ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:**
```
ERROR:group_digest_generator:‚ùå n8n workflow error: 500
ERROR:group_digest_generator:‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–π–¥–∂–µ—Å—Ç–∞: n8n workflow failed: 500
```

**n8n –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**, –Ω–æ –±–æ—Ç –∏—Ö –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –∏–∑-–∑–∞ 500 –æ—à–∏–±–∫–∏.

---

## ‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ n8n UI

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ n8n

```
https://n8n.produman.studio
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∫–∏–µ workflows –∞–∫—Ç–∏–≤–Ω—ã

**Workflows ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:**

| Workflow | –î–æ–ª–∂–µ–Ω –±—ã—Ç—å |
|----------|-------------|
| Group Digest Orchestrator (Sub-workflows) | ‚úÖ **Active (–∑–µ–ª–µ–Ω—ã–π)** |
| Group Dialogue Multi-Agent Analyzer v2 | ‚ùå **Inactive (—Å–µ—Ä—ã–π)** |
| Agent: Topic Extractor | ‚ö™ –ù–µ –∞–∫—Ç–∏–≤–µ–Ω (–Ω–æ—Ä–º–∞–ª—å–Ω–æ!) |
| Agent: Speaker Analyzer | ‚ö™ –ù–µ –∞–∫—Ç–∏–≤–µ–Ω (–Ω–æ—Ä–º–∞–ª—å–Ω–æ!) |
| Agent: Context Summarizer | ‚ö™ –ù–µ –∞–∫—Ç–∏–≤–µ–Ω (–Ω–æ—Ä–º–∞–ª—å–Ω–æ!) |

**–ï—Å–ª–∏ v2 –∞–∫—Ç–∏–≤–µ–Ω:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ "Group Dialogue Multi-Agent Analyzer v2"
2. Active ‚Üí **OFF**
3. Save

**–ï—Å–ª–∏ Orchestrator –ù–ï –∞–∫—Ç–∏–≤–µ–Ω:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ "Group Digest Orchestrator"
2. Active ‚Üí **ON**
3. Save

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Execute Workflow —É–∑–ª—ã –≤ Orchestrator

1. –û—Ç–∫—Ä–æ–π—Ç–µ **"Group Digest Orchestrator"**
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —É–∑–µ–ª **"Execute: Topic Extractor"**
3. –í –ø–æ–ª–µ **"Workflow"** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω–æ: **"Agent: Topic Extractor"**
4. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö Execute —É–∑–ª–æ–≤:
   - Execute: Speaker Analyzer ‚Üí Agent: Speaker Analyzer
   - Execute: Summarizer ‚Üí Agent: Context Summarizer

**–ï—Å–ª–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ:**
- –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π agent –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
- Save
- Active ‚Üí ON

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ Executions

1. –í –º–µ–Ω—é —Å–ª–µ–≤–∞: **Executions**
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:**
- ‚úÖ Group Digest Orchestrator - **–∑–µ–ª–µ–Ω—ã–π** (success)
- ‚úÖ Agent: Topic Extractor - –∑–µ–ª–µ–Ω—ã–π
- ‚úÖ Agent: Speaker Analyzer - –∑–µ–ª–µ–Ω—ã–π
- ‚úÖ Agent: Context Summarizer - –∑–µ–ª–µ–Ω—ã–π

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –∫—Ä–∞—Å–Ω—ã–µ (–æ—à–∏–±–∫–∏):**
1. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫—Ä–∞—Å–Ω—ã–π execution
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫–æ–π —É–∑–µ–ª —É–ø–∞–ª
3. –û—Ç–∫—Ä–æ–π—Ç–µ —ç—Ç–æ—Ç —É–∑–µ–ª
4. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –æ—à–∏–±–∫—É –≤ –ª–æ–≥–∞—Ö

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- "Referenced node doesn't exist" ‚Üí Execute —É–∑–ª—ã –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–®–∞–≥ 3)
- "Workflow not found" ‚Üí –ê–≥–µ–Ω—Ç—ã –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- GigaChat timeout ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ gpt2giga-proxy

---

### –®–∞–≥ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ workflow –≤—Ä—É—á–Ω—É—é

1. –û—Ç–∫—Ä–æ–π—Ç–µ **"Group Digest Orchestrator"**
2. –ù–∞–∂–º–∏—Ç–µ **Execute Workflow** (—Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)
3. –í test panel —É–∫–∞–∂–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:

```json
{
  "messages": [
    {"username": "alice", "text": "–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º!", "date": "2025-10-13T10:00:00Z"},
    {"username": "bob", "text": "–ö–∞–∫ –¥–µ–ª–∞?", "date": "2025-10-13T10:01:00Z"}
  ],
  "user_id": 1,
  "group_id": 1,
  "hours": 6
}
```

4. –ù–∞–∂–º–∏—Ç–µ **Execute**
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ —É–∑–ª—ã –∑–µ–ª–µ–Ω—ã–µ
6. –û—Ç–∫—Ä–æ–π—Ç–µ —É–∑–µ–ª **"Aggregate Results"**
7. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ Output –µ—Å—Ç—å:
   - topics: [...]
   - speakers_summary: {...}
   - overall_summary: "..."
   - message_count: 2
   - period: "6 hours"

**–ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ** ‚Üí workflow –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –≤ —á–µ–º-—Ç–æ –¥—Ä—É–≥–æ–º.

**–ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è** ‚Üí —Å–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫–æ–π —É–∑–µ–ª –∫—Ä–∞—Å–Ω—ã–π –∏ –∏—Å–ø—Ä–∞–≤–ª—è–π—Ç–µ.

---

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: v2 –∏ Orchestrator –æ–±–∞ –∞–∫—Ç–∏–≤–Ω—ã

**–°–∏–º–ø—Ç–æ–º:** –í —Å–ø–∏—Å–∫–µ workflows –æ–±–∞ –∑–µ–ª–µ–Ω—ã–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ v2: Active OFF
2. –û—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ Orchestrator: Active ON

**–ü—Ä–∏—á–∏–Ω–∞:** –û–±–∞ —Å–ª—É—à–∞—é—Ç `/webhook/group-digest`, –∫–æ–Ω—Ñ–ª–∏–∫—Ç!

---

### –ü—Ä–æ–±–ª–µ–º–∞: Orchestrator –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π

**–°–∏–º–ø—Ç–æ–º:** –ö—Ä–∞—Å–Ω—ã–µ executions –≤ –ª–æ–≥–∞—Ö

**–ü—Ä–∏—á–∏–Ω—ã:**
1. Execute —É–∑–ª—ã –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
2. –ê–≥–µ–Ω—Ç—ã –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
3. gpt2giga-proxy –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Execute —É–∑–ª—ã (–®–∞–≥ 3)
2. –†–µ–∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∞–≥–µ–Ω—Ç–æ–≤ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ gpt2giga-proxy:
   ```bash
   docker ps | grep gpt2giga
   docker logs gpt2giga-proxy
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ê–≥–µ–Ω—Ç—ã –Ω–µ –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ

**–°–∏–º–ø—Ç–æ–º:** –ù–µ –º–æ–≥—É –≤—ã–±—Ä–∞—Ç—å Agent –≤ Execute —É–∑–ª–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –ê–≥–µ–Ω—Ç—ã –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. Import from File ‚Üí agent_topic_extractor.json
2. Import from File ‚Üí agent_speaker_analyzer.json
3. Import from File ‚Üí agent_summarizer.json
4. –ù–ï –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∞–≥–µ–Ω—Ç–æ–≤!
5. –ü–æ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Execute —É–∑–ª—ã –≤ Orchestrator

---

## ‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ Telegram –±–æ—Ç–µ:**
   ```
   /group_digest 8
   ```

2. **–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:**
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π period: "8 hours"
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π message_count (—Ä–µ–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ)
   - ‚úÖ –¢–µ–º—ã –∏–∑–≤–ª–µ—á–µ–Ω—ã
   - ‚úÖ –°–ø–∏–∫–µ—Ä—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
   - ‚úÖ –†–µ–∑—é–º–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ
   - ‚úÖ **–ë–ï–ó –æ—à–∏–±–∫–∏ Markdown!**

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ n8n Executions:**
   - –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å 4 –∑–µ–ª–µ–Ω—ã—Ö execution
   - Orchestrator + 3 –∞–≥–µ–Ω—Ç–∞

---

## üìä –ß–µ–∫–ª–∏—Å—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

- [ ] v2 –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω (Active OFF)
- [ ] Orchestrator –∞–∫—Ç–∏–≤–µ–Ω (Active ON)
- [ ] Execute —É–∑–ª—ã –≤ Orchestrator –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–∞–≥–µ–Ω—Ç—ã –≤—ã–±—Ä–∞–Ω—ã)
- [ ] –ê–≥–µ–Ω—Ç—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã (–ù–ï –∞–∫—Ç–∏–≤–Ω—ã)
- [ ] –†—É—á–Ω–æ–π —Ç–µ—Å—Ç Orchestrator –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ
- [ ] gpt2giga-proxy —Ä–∞–±–æ—Ç–∞–µ—Ç (docker ps)
- [ ] `/group_digest 8` —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ù–µ—Ç –æ—à–∏–±–∫–∏ "Can't parse entities"

---

## üéì –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Python

**–§–∞–π–ª:** `telethon/group_digest_generator.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Markdown –≤ `format_digest_for_telegram`
- ‚úÖ –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã: topics, usernames, summaries, reasons, key_points
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escape_markdown_v2()` –∏–∑ `markdown_utils.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ë–æ–ª—å—à–µ –Ω–µ—Ç –æ—à–∏–±–∫–∏ "Can't parse entities"
- –í—Å–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

---

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ —ç—Ç–æ–º—É —á–µ–∫–ª–∏—Å—Ç—É –∏ —Å–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!** üöÄ

