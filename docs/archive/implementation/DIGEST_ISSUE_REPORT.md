# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–µ —Å –¥–∞–π–¥–∂–µ—Å—Ç–∞–º–∏

**–î–∞—Ç–∞:** 15 –æ–∫—Ç—è–±—Ä—è 2025  
**–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤:** 09:00 MSK (06:00 UTC)

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### User ID: 6 (telegram_id: 8124731874)
- ‚úÖ **–î–∞–π–¥–∂–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω:** 09:00:02 MSK
- ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:** enabled=True, AI summarize=True
- ‚úÖ **–ü–æ—Å—Ç—ã –∑–∞ 24—á:** 129 –ø–æ—Å—Ç–æ–≤ –∏–∑ 15 –∫–∞–Ω–∞–ª–æ–≤
- ‚ö†Ô∏è  **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–æ–ª—å–∫–æ 1 —Ç–µ–º–∞ —Å 1 –ø–æ—Å—Ç–æ–º –≤ –¥–∞–π–¥–∂–µ—Å—Ç–µ
- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:** AI-–¥–∞–π–¥–∂–µ—Å—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—É—Å—Ç–æ–π (1 –ø–æ—Å—Ç –≤–º–µ—Å—Ç–æ 129)

### User ID: 19 (telegram_id: 139883458, username: ilyasni)
- ‚úÖ **–î–∞–π–¥–∂–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω:** 09:00:01 MSK
- ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:** enabled=True, AI summarize=True
- ‚úÖ **–ü–æ—Å—Ç—ã –∑–∞ 24—á:** 8 –ø–æ—Å—Ç–æ–≤ –∏–∑ 4 –∫–∞–Ω–∞–ª–æ–≤
- ‚ö†Ô∏è  **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 0 —Ç–µ–º –≤ –¥–∞–π–¥–∂–µ—Å—Ç–µ
- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:** AI-–¥–∞–π–¥–∂–µ—Å—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–æ–π (0 –ø–æ—Å—Ç–æ–≤)

### User ID: 18 (telegram_id: 488909738, username: mrf_flowers)
- ‚ùå **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ —Å–æ–∑–¥–∞–Ω—ã** (enabled –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- ‚ùå **–ü–æ—Å—Ç—ã:** 0 (–Ω–µ—Ç –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –∫–∞–Ω–∞–ª—ã)
- ‚ùå **–î–∞–π–¥–∂–µ—Å—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª—Å—è**

---

## üî¥ –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê

### –ü—Ä–æ–±–ª–µ–º–∞ 1: GigaChat Rate Limit (429 Too Many Requests)

**–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:**
```
2025-10-15 09:00:00,221 - embeddings - ERROR - ‚ùå –û—à–∏–±–∫–∞ GigaChat embeddings: 
(URL('https://gigachat.devices.sberbank.ru/api/v1/embeddings'), 429, 
b'{"status":429,"message":"Too Many Requests"}\\n')
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
1. –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç –¥–∞–π–¥–∂–µ—Å—Ç—ã –¥–ª—è **–æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** –≤ 09:00
2. AI-–¥–∞–π–¥–∂–µ—Å—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å **5 —Ç–µ–º** (preferred_topics)
3. –î–ª—è –∫–∞–∂–¥–æ–π —Ç–µ–º—ã –¥–µ–ª–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –∫ GigaChat embeddings API
4. **2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è √ó 5 —Ç–µ–º = 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** –∫ GigaChat
5. GigaChat API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **429 (Too Many Requests)** –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
6. Fallback –Ω–∞ sentence-transformers **–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**
7. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–µ–º –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç –ø–æ—Å—Ç—ã

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ–º–∞–º:**

**User 6 (5 —Ç–µ–º):**
- ‚ùå AI ‚Üí 429 error, fallback failed
- ‚ùå –±–ª–æ–∫—á–µ–π–Ω ‚Üí 429 error, fallback failed
- ‚úÖ –∞–≤—Ç–æ ‚Üí 1 –ø–æ—Å—Ç –Ω–∞–π–¥–µ–Ω
- ‚ùå —Å—Ç–∞—Ä—Ç–∞–ø—ã ‚Üí 0 –ø–æ—Å—Ç–æ–≤
- ‚ùå —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ ‚Üí 0 –ø–æ—Å—Ç–æ–≤

**User 19 (5 —Ç–µ–º):**
- ‚ùå AI ‚Üí 429 error, fallback failed
- ‚ùå —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ ‚Üí 429 error, fallback failed
- ‚ùå digital ‚Üí 0 –ø–æ—Å—Ç–æ–≤
- ‚ùå –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –¥–∏–∑–∞–π–Ω ‚Üí 429 error, fallback failed
- ‚ùå —Å—Ç–∞—Ä—Ç–∞–ø—ã ‚Üí 0 –ø–æ—Å—Ç–æ–≤

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–î–∞–∂–µ –∫–æ–≥–¥–∞ embeddings —Ä–∞–±–æ—Ç–∞—é—Ç:**
```
2025-10-15 09:00:00,363 - vector_db - INFO - üîç –ù–∞–π–¥–µ–Ω–æ 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è user 6
2025-10-15 09:00:00,449 - vector_db - INFO - üîç –ù–∞–π–¥–µ–Ω–æ 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è user 19
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–ª–∞:**

**User 6:**
- ‚úÖ **410 –ø–æ—Å—Ç–æ–≤ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ** –≤ Qdrant
- ‚ö†Ô∏è **9 –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –±–µ–∑ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏** (–ø–æ—è–≤–∏–ª–∏—Å—å –ø–æ—Å–ª–µ 06:24)
- üìÖ –ü–æ—Å–ª–µ–¥–Ω—è—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è: 06:24 (–ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–π–¥–∂–µ—Å—Ç–∞)

**User 19:**
- ‚úÖ **10 –ø–æ—Å—Ç–æ–≤ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ** –≤ Qdrant
- ‚úÖ –í—Å–µ –ø–æ—Å—Ç—ã –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
- ‚ö†Ô∏è –ü–æ—Å–ª–µ–¥–Ω—è—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è: **14+ —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥** (19:34 –≤—á–µ—Ä–∞)

**–†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. ‚úÖ –ü–æ—Å—Ç—ã –ü–†–û–ò–ù–î–ï–ö–°–ò–†–û–í–ê–ù–´ –≤ Qdrant (–∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ù–ï –ø—É—Å—Ç—ã–µ)
2. ‚ùå –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –≤—Å–µ —Ä–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø–æ–∏—Å–∫–∞ –∏–ª–∏ –∫–∞—á–µ—Å—Ç–≤–µ embeddings
4. ‚ùå –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ embeddings –ø—Ä–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ vs –ø–æ–∏—Å–∫–µ

---

## üîß –†–ï–®–ï–ù–ò–Ø

### –†–µ—à–µ–Ω–∏–µ 1: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ Rate Limit (–ö–†–ò–¢–ò–ß–ù–û)

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º (–±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ)
```python
# telethon/rag_service/ai_digest_generator.py

# –í–ú–ï–°–¢–û –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö —Ç–µ–º:
for topic in topics[:topics_limit]:
    posts = await self._search_posts_for_topic(...)
    await asyncio.sleep(0.5)  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏

# –î–æ–±–∞–≤–∏—Ç—å retry —Å exponential backoff –¥–ª—è 429 –æ—à–∏–±–æ–∫
```

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ fallback embeddings (–Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)
```bash
# –í Dockerfile.telethon –∏–ª–∏ requirements.txt
pip install sentence-transformers torch
```

#### –í–∞—Ä–∏–∞–Ω—Ç –í: –ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ GigaChat
```python
# –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å embeddings –∑–∞–ø—Ä–æ—Å—ã –±–∞—Ç—á–∞–º–∏ –ø–æ 3-5 —Ç–µ–º
# –° –∑–∞–¥–µ—Ä–∂–∫–æ–π –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏
```

#### –í–∞—Ä–∏–∞–Ω—Ç –ì: –°–º–µ—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤
```python
# User 6: 09:00 MSK
# User 19: 09:05 MSK
# User 18: 09:10 MSK
# –ò–∑–±–µ–∂–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
```

---

### –†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤ Qdrant

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏
curl http://localhost:6333/collections

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –¥–ª—è user 6
curl http://localhost:6333/collections/telegram_posts_6/points/count

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã
SELECT * FROM indexing_status WHERE user_id = 6 ORDER BY indexed_at DESC LIMIT 10;
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø–æ—Å—Ç—ã –≤ –ë–î, –Ω–æ –Ω–µ –≤ Qdrant
2. –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∑–∞–ø–∞–∑–¥—ã–≤–∞–µ—Ç ‚Üí –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã –µ—â–µ –Ω–µ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
3. –û—à–∏–±–∫–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∏–Ω–¥–µ–∫—Å–∞—Ç–æ—Ä–∞

---

### –†–µ—à–µ–Ω–∏–µ 3: Fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç

**–ï—Å–ª–∏ AI-–¥–∞–π–¥–∂–µ—Å—Ç –ø—É—Å—Ç–æ–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç:**
```python
# telethon/rag_service/ai_digest_generator.py

if not topic_summaries:
    logger.warning(f"‚ö†Ô∏è AI-–¥–∞–π–¥–∂–µ—Å—Ç –ø—É—Å—Ç–æ–π –¥–ª—è user {user_id}, –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç")
    # –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –∏–∑ –ë–î
    return await self._generate_fallback_digest(user_id, date_from, date_to)
```

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (—Å–µ–≥–æ–¥–Ω—è):

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å sentence-transformers –¥–ª—è fallback:**
   ```bash
   docker exec rag-service pip install sentence-transformers torch
   docker restart rag-service
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É –¥–ª—è 429 –æ—à–∏–±–æ–∫:**
   - Exponential backoff (0.5s ‚Üí 1s ‚Üí 2s)
   - –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ fallback –ø–æ—Å–ª–µ 3-–π –ø–æ–ø—ã—Ç–∫–∏

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –≤ Qdrant:**
   - –°–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–æ–≤ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–æ
   - –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
   - –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –∏–Ω–¥–µ–∫—Å–∞—Ç–æ—Ä

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (—ç—Ç–∞ –Ω–µ–¥–µ–ª—è):

4. **–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ GigaChat:**
   - 0.3-0.5 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Ç–µ–º–∞–º–∏
   - –ë–∞—Ç—á–∏–Ω–≥ –ø–æ 3 —Ç–µ–º—ã –∑–∞ —Ä–∞–∑

5. **–°–º–µ—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   - –†–∞–∑–Ω–µ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 5-10 –º–∏–Ω—É—Ç
   - –ò–∑–±–µ–∂–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö Rate Limits

6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Rate Limits:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å 429 –æ—à–∏–±–∫–∏
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 50% failed requests

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (—Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü):

7. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ embeddings:**
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å embeddings –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–µ–º
   - –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ GigaChat

8. **Fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç:**
   - –ï—Å–ª–∏ AI-–¥–∞–π–¥–∂–µ—Å—Ç –ø—É—Å—Ç–æ–π ‚Üí –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—ã—á–Ω—ã–π
   - –ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º (AI + —Ç–æ–ø –ø–æ—Å—Ç–æ–≤ –ø–æ views)

9. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã similarity threshold
   - –£–≤–µ–ª–∏—á–∏—Ç—å limit —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (—Å–µ–π—á–∞—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5-10)

---

## üìù –í—ã–≤–æ–¥—ã

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–∞–π–¥–∂–µ—Å—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–±–æ–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:**
- ‚úÖ User 6: –¥–∞–π–¥–∂–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω (–Ω–æ —Ç–æ–ª—å–∫–æ 1 –ø–æ—Å—Ç –∏–∑ 129)
- ‚úÖ User 19: –¥–∞–π–¥–∂–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω (–Ω–æ 0 –ø–æ—Å—Ç–æ–≤ –∏–∑ 8)

**–ù–æ –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤ –∫—Ä–∞–π–Ω–µ –Ω–∏–∑–∫–æ–µ –∏–∑-–∑–∞:**
1. ‚ùå GigaChat Rate Limit (429 Too Many Requests)
2. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ fallback embeddings
3. ‚ùå –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π –≤ Qdrant
4. ‚ùå –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
1. üî¥ **–ö–†–ò–¢–ò–ß–ù–û:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å sentence-transformers
2. üî¥ **–ö–†–ò–¢–ò–ß–ù–û:** –î–æ–±–∞–≤–∏—Ç—å retry —Å backoff –¥–ª—è 429
3. üü° **–í–ê–ñ–ù–û:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –≤ Qdrant
4. üü° **–í–ê–ñ–ù–û:** –î–æ–±–∞–≤–∏—Ç—å fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç
5. üü¢ **–ñ–ï–õ–ê–¢–ï–õ–¨–ù–û:** –°–º–µ—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç:** `/telethon/scripts/debug_digest.py`

