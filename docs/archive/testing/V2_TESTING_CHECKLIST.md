# ‚úÖ V2 Digest System - Testing Checklist

**–î–∞—Ç–∞:** 14 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** Ready for Testing

---

## Pre-Check: –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```bash
‚úÖ telethon - Up 29 minutes
‚úÖ n8n - Up 14 hours (executions —É—Å–ø–µ—à–Ω—ã)
‚úÖ gpt2giga-proxy - (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞–µ—Ç)
```

### V2 Pipeline Configuration

```bash
‚úÖ USE_DIGEST_V2=True (–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω)
‚úÖ V2 Webhook: http://n8n:5678/webhook/group-digest-v2
‚úÖ Timeout: 180 seconds
```

### n8n Workflows Status

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ n8n UI (http://your-domain:5678):**

- [ ] Agent: Dialogue Assessor - Imported & Active
- [ ] Agent: Emotion Analyzer - Imported & Active
- [ ] Agent: Topic Extractor - Updated & Active
- [ ] Agent: Speaker Analyzer - Updated & Active
- [ ] Agent: Context Summarizer - Updated & Active
- [ ] Agent: Key Moments Extractor - Imported & Active
- [ ] Agent: Timeline Builder - Imported & Active
- [ ] Agent: Context Links Analyzer - Imported & Active
- [ ] Agent: Supervisor Synthesizer - Imported & Active
- [ ] Group Digest Orchestrator V2 - Imported & Active
  - [ ] Execute Workflow node "1. Assessor" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Dialogue Assessor"
  - [ ] Execute Workflow node "2. Topics" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Topic Extractor"
  - [ ] Execute Workflow node "3. Emotions" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Emotion Analyzer"
  - [ ] Execute Workflow node "4. Speakers" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Speaker Analyzer"
  - [ ] Execute Workflow node "5. Summarizer" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Context Summarizer"
  - [ ] Execute Workflow node "6. Key Moments" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Key Moments Extractor"
  - [ ] Execute Workflow node "7. Timeline" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Timeline Builder"
  - [ ] Execute Workflow node "8. Context Links" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Context Links Analyzer"
  - [ ] Execute Workflow node "9. Synthesizer" ‚Üí –≤—ã–±—Ä–∞–Ω "Agent: Supervisor Synthesizer"

---

## Test 1: UX Improvements (Already Working)

### ‚úÖ Test Inline Keyboards

**–í Telegram –±–æ—Ç–µ:**

```
/group_digest
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ –ü–æ—è–≤–ª—è—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≥—Ä—É–ø–ø—ã
- ‚úÖ –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≥—Ä—É–ø–ø—ã ‚Üí –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ (2—á, 8—á, 12—á, 24—á)
- ‚úÖ –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ ‚Üí –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

```
/my_groups
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ –°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø —Å inline –∫–Ω–æ–ø–∫–∞–º–∏
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "üìä –ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã" –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"

### ‚úÖ Test Copyable Commands

```
/group_settings
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å —Ç–µ–≥–æ–º `<code>`
- ‚úÖ –ú–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º

### ‚úÖ Test Clickable Usernames

**–ó–∞–ø—Ä–æ—Å–∏—Ç—å –ª—é–±–æ–π –¥–∞–π–¥–∂–µ—Å—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- ‚úÖ `@username` –≤ —Å–µ–∫—Ü–∏–∏ "–ê–∫—Ç–∏–≤–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏" –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã
- ‚úÖ –ü—Ä–∏ –∫–ª–∏–∫–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## Test 2: V2 Pipeline (Micro Level)

### –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –≥—Ä—É–ø–ø—É —Å 3-5 —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

**–í –±–æ—Ç–µ:**

```
/group_digest
‚Üí –í—ã–±—Ä–∞—Ç—å –≥—Ä—É–ø–ø—É —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π
‚Üí –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥: 2—á
‚Üí –û–∂–∏–¥–∞—Ç—å <15 —Å–µ–∫—É–Ω–¥
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (micro level):**

```
üòä –ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–∞—è –±–µ—Å–µ–¥–∞

–û–±—Å—É–¥–∏–ª–∏ [–∫—Ä–∞—Ç–∫–∞—è —Å—É—Ç—å]. –¢–æ–Ω: [—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–∫—Ä–∞—Å].
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:**

```bash
docker logs telethon | grep -A5 "Detail Level:"
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
Detail Level: micro
Dialogue Type: casual_chat
```

---

## Test 3: V2 Pipeline (Minimal Level)

### –ì—Ä—É–ø–ø–∞ —Å 6-15 —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

```
/group_digest
‚Üí –í—ã–±—Ä–∞—Ç—å –≥—Ä—É–ø–ø—É —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π
‚Üí –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥: 8—á
‚Üí –û–∂–∏–¥–∞—Ç—å <25 —Å–µ–∫—É–Ω–¥
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (minimal level):**

```
üìä –î–∞–π–¥–∂–µ—Å—Ç: [–ø–µ—Ä–∏–æ–¥] | [—Å–æ–æ–±—â–µ–Ω–∏–π] —Å–æ–æ–±—â–µ–Ω–∏–π

üéØ –¢–µ–º—ã:
1. –¢–µ–º–∞ 1
2. –¢–µ–º–∞ 2

üòä/üòê/üòî –¢–æ–Ω: [–æ–ø–∏—Å–∞–Ω–∏–µ] (–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å: 0.X)

üìù –°—É—Ç—å:
[–û–¥–∏–Ω –ø–∞—Ä–∞–≥—Ä–∞—Ñ —Ä–µ–∑—é–º–µ]
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- [ ] –ï—Å—Ç—å —Ç–µ–º—ã
- [ ] –ï—Å—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–Ω —Å —ç–º–æ–¥–∑–∏
- [ ] –ï—Å—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã
- [ ] –†–µ–∑—é–º–µ –∫—Ä–∞—Ç–∫–æ–µ (1 –ø–∞—Ä–∞–≥—Ä–∞—Ñ)

---

## Test 4: V2 Pipeline (Standard Level) ‚≠ê

### –ì—Ä—É–ø–ø–∞ —Å 16-50 —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

```
/group_digest
‚Üí –í—ã–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –≥—Ä—É–ø–ø—É
‚Üí –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥: 12—á
‚Üí –û–∂–∏–¥–∞—Ç—å 40-60 —Å–µ–∫—É–Ω–¥
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (standard level):**

```
üìä –î–∞–π–¥–∂–µ—Å—Ç: [–≥—Ä—É–ø–ø–∞] | [–ø–µ—Ä–∏–æ–¥] | [—Å–æ–æ–±—â–µ–Ω–∏–π] —Å–æ–æ–±—â–µ–Ω–∏–π
üìã –¢–∏–ø: problem_solving | –£—Ä–æ–≤–µ–Ω—å: standard

üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã:
1. üî¥/üü°/üü¢ –¢–µ–º–∞ 1 (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: high/medium/low)
2. –¢–µ–º–∞ 2 (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ...)

üòê –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–Ω: [–æ–ø–∏—Å–∞–Ω–∏–µ] (0.XX)
   –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: [–¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]
   –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã: conflict: XX%, collaboration: XX%, stress: XX%, enthusiasm: XX%

üë• –ê–∫—Ç–∏–≤–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏:
‚Ä¢ @username1: [—Ä–æ–ª—å] - [–≤–∫–ª–∞–¥]
‚Ä¢ @username2: [—Ä–æ–ª—å] - [–≤–∫–ª–∞–¥]

‚ö° –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:

‚úÖ –†–ï–®–ï–ù–ò–ï: [–æ–ø–∏—Å–∞–Ω–∏–µ]
   –ö–æ–Ω—Ç–µ–∫—Å—Ç: [–∫–æ–Ω—Ç–µ–∫—Å—Ç]
   –£—á–∞—Å—Ç–Ω–∏–∫–∏: @user1, @user2
   –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è: [–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è]
   –≠–º–æ—Ü. –∫–æ–Ω—Ç–µ–∫—Å—Ç: [—ç–º–æ—Ü–∏–∏]
   –°—Ä–æ—á–Ω–æ—Å—Ç—å: high/medium/low

üìù –†–µ–∑—é–º–µ:
[2-3 –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º]
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- [ ] –ï—Å—Ç—å —Ç–µ–º—ã —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ (high/medium/low)
- [ ] –ï—Å—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏
- [ ] –ï—Å—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∏ —Å —Ä–æ–ª—è–º–∏
- [ ] –ï—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã (‚úÖ —Ä–µ—à–µ–Ω–∏—è, ‚ùì –≤–æ–ø—Ä–æ—Å—ã, ‚ö†Ô∏è –ø—Ä–æ–±–ª–µ–º—ã)
- [ ] –†–µ–∑—é–º–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- [ ] Username –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã
- [ ] –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ <60 —Å–µ–∫—É–Ω–¥

---

## Test 5: V2 Pipeline (Detailed Level)

### –ì—Ä—É–ø–ø–∞ —Å 51-100 —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

```
/group_digest
‚Üí –í—ã–±—Ä–∞—Ç—å –æ—á–µ–Ω—å –∞–∫—Ç–∏–≤–Ω—É—é –≥—Ä—É–ø–ø—É
‚Üí –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥: 24—á
‚Üí –û–∂–∏–¥–∞—Ç—å 75-100 —Å–µ–∫—É–Ω–¥
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (detailed level):**

```
[–í–µ—Å—å Standard —Ñ–æ—Ä–º–∞—Ç] +

üìÖ –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è:
12:30 üü¢ [–°–æ–±—ã—Ç–∏–µ 1]
13:00 üü° [–°–æ–±—ã—Ç–∏–µ 2]
13:30 üü† [–°–æ–±—ã—Ç–∏–µ 3]
...

üìà –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞:
[–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∫ –º–µ–Ω—è–ª–∞—Å—å –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞]
–ü—Ä–µ–æ–±–ª–∞–¥–∞—é—â–∏–µ —ç–º–æ—Ü–∏–∏: [—Å–ø–∏—Å–æ–∫ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏]
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- [ ] –ï—Å—Ç—å —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
- [ ] –ï—Å—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —ç–º–æ–¥–∑–∏ (üü¢üü°üü†üî¥üîµ)
- [ ] –ï—Å—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–∏
- [ ] –ï—Å—Ç—å –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—â–∏–µ —ç–º–æ—Ü–∏–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏

---

## Test 6: Error Handling

### Test –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```
/group_digest
‚Üí –í—ã–±—Ä–∞—Ç—å –≥—Ä—É–ø–ø—É
‚Üí –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä–∏–æ–¥: 2—á (–≥–¥–µ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π)
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
```
üì≠ –ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–æ–≤ –≤ –≥—Ä—É–ø–ø–µ –Ω–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: 0
```

### Test timeout (–µ—Å–ª–∏ –¥–æ–ª–≥–æ)

**–ï—Å–ª–∏ –¥–∞–π–¥–∂–µ—Å—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è >3 –º–∏–Ω—É—Ç:**

```
‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–π–¥–∂–µ—Å—Ç–∞: n8n workflow timeout after 180s
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å timeout
echo "N8N_DIGEST_TIMEOUT_V2=240" >> .env
docker compose restart telethon
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

### Check Detail Level Detection

```bash
docker logs telethon | grep "Detail Level:" | tail -5
```

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:**
```
Detail Level: micro        (–¥–ª—è 1-5 messages)
Detail Level: minimal      (–¥–ª—è 6-15 messages)
Detail Level: standard     (–¥–ª—è 16-50 messages)
Detail Level: detailed     (–¥–ª—è 51-100 messages)
Detail Level: comprehensive (–¥–ª—è >100 messages)
```

### Check Pipeline Execution

```bash
docker logs telethon | grep "Pipeline:" | tail -3
```

**–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:**
```
Pipeline: V2 Sequential
```

### Check Agent Results

```bash
docker logs telethon | grep -E "(Topics extracted|Emotion analysis|Key moments)" | tail -10
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –∑–∞–ø–∏—Å–∏:**
```
‚úÖ Topics extracted: 3
‚úÖ Emotion analysis —É—Å–ø–µ—à–Ω–æ: neutral
‚úÖ Key moments extracted: 2 –º–æ–º–µ–Ω—Ç–æ–≤
```

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ V1 vs V2

### –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –¥–∞–π–¥–∂–µ—Å—Ç –¥–≤–∞–∂–¥—ã

**Test V1 (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å V2):**

```bash
# –í .env –∏–ª–∏ —á–µ—Ä–µ–∑ environment
USE_DIGEST_V2=false
docker compose restart telethon

# –ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–π–¥–∂–µ—Å—Ç
/group_digest ‚Üí [–≤—ã–±—Ä–∞—Ç—å –≥—Ä—É–ø–ø—É –∏ –ø–µ—Ä–∏–æ–¥]

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
```

**Test V2 (–≤–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞—Ç–Ω–æ):**

```bash
USE_DIGEST_V2=true
docker compose restart telethon

# –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–æ—Ç –∂–µ –¥–∞–π–¥–∂–µ—Å—Ç
/group_digest ‚Üí [—Ç–∞ –∂–µ –≥—Ä—É–ø–ø–∞ –∏ –ø–µ—Ä–∏–æ–¥]
```

**–°—Ä–∞–≤–Ω–∏—Ç—å:**
- V2 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
- V2 —Å–æ–¥–µ—Ä–∂–∏—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- V2 —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã (–¥–ª—è standard+)
- V2 –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π (–∫–æ—Ä–æ—á–µ –¥–ª—è –º–∞–ª—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤)

---

## Known Issues & Solutions

### Issue 1: "n8n workflow failed: 404"

**–ü—Ä–∏—á–∏–Ω–∞:** Orchestrator V2 –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (Execute Workflow nodes –ø—É—Å—Ç—ã–µ)

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å workflow "Group Digest Orchestrator V2" –≤ n8n UI
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ Execute Workflow node –≤—ã–±—Ä–∞—Ç—å workflow
3. Save & Activate

### Issue 2: "Assessment not available"

**–ü—Ä–∏—á–∏–Ω–∞:** Agent: Dialogue Assessor –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ workflow –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å workflow
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Execute Workflow Trigger –¥–æ—Å—Ç—É–ø–µ–Ω

### Issue 3: –ü—É—Å—Ç—ã–µ key_moments

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è micro/minimal levels!**

Key moments –∞–∫—Ç–∏–≤–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è:
- standard (16+ messages)
- detailed (51+ messages)
- comprehensive (101+ messages)

### Issue 4: Timeout –¥–ª—è detailed/comprehensive

**–ù–æ—Ä–º–∞–ª—å–Ω–æ!** –≠—Ç–∏ —É—Ä–æ–≤–Ω–∏ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏.

**–ï—Å–ª–∏ timeout:**
```bash
N8N_DIGEST_TIMEOUT_V2=300  # 5 –º–∏–Ω—É—Ç
docker compose restart telethon
```

---

## Success Criteria

### ‚úÖ UX Improvements Working

- [x] Inline keyboards –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
- [x] –í—ã–±–æ—Ä –≥—Ä—É–ø–ø—ã —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ö–æ–º–∞–Ω–¥—ã –∫–æ–ø–∏—Ä—É–µ–º—ã–µ
- [x] Username –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ

### ‚úÖ V2 Pipeline Working

- [ ] Micro digests –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è (<15s)
- [ ] Minimal digests –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è (<25s)
- [ ] Standard digests —Å –∫–ª—é—á–µ–≤—ã–º–∏ –º–æ–º–µ–Ω—Ç–∞–º–∏ (<60s)
- [ ] –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- [ ] Detail level –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

### ‚úÖ Quality Improvements

- [ ] –î–∞–π–¥–∂–µ—Å—Ç—ã –±–æ–ª–µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ï—Å—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ç–µ–º
- [ ] –ï—Å—Ç—å –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã (—Ä–µ—à–µ–Ω–∏—è, –≤–æ–ø—Ä–æ—Å—ã, –ø—Ä–æ–±–ª–µ–º—ã)
- [ ] –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ
- [ ] –ú–∞–ª—ã–µ –¥–∏–∞–ª–æ–≥–∏ –Ω–µ –∏–∑–±—ã—Ç–æ—á–Ω—ã (micro/minimal)
- [ ] –ë–æ–ª—å—à–∏–µ –¥–∏–∞–ª–æ–≥–∏ –Ω–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã (detailed/comprehensive)

---

## Debug Commands

### Check –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–∞–π–¥–∂–µ—Å—Ç –≤ –ª–æ–≥–∞—Ö

```bash
docker logs telethon | grep -A20 "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–π–¥–∂–µ—Å—Ç–∞" | tail -25
```

### Check n8n execution logs

```bash
docker logs n8n | grep -E "(Enqueued|finished|Error)" | tail -20
```

### Check V2 webhook calls

```bash
docker logs telethon | grep "group-digest-v2" | tail -5
```

### Manual test V2 webhook (–µ—Å–ª–∏ workflows –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)

```bash
curl -X POST http://n8n:5678/webhook/group-digest-v2 \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      {"username": "Test1", "text": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?", "date": "2025-10-14T12:00:00Z"},
      {"username": "Test2", "text": "–û—Ç–ª–∏—á–Ω–æ! –û–±—Å—É–∂–¥–∞–µ–º –ø—Ä–æ–µ–∫—Ç", "date": "2025-10-14T12:05:00Z"}
    ],
    "user_id": 123,
    "group_id": 456,
    "group_title": "Test Group",
    "hours": 12
  }'
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å:
```json
{
  "detail_level": "micro",
  "dialogue_type": "casual_chat",
  "emotions": {...},
  "topics": [...],
  "digest_html": "..."
}
```

---

## Rollback Plan

### –ï—Å–ª–∏ V2 —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–æ—Ö–æ

```bash
# 1. –û—Ç–∫–ª—é—á–∏—Ç—å V2
USE_DIGEST_V2=false

# 2. Restart
docker compose restart telethon

# 3. Verify
docker logs telethon | grep "Use V2 Pipeline:"
# Output: Use V2 Pipeline: False

# 4. Test
/group_digest
# –î–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å V1 parallel pipeline
```

---

## Next Steps

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

### Week 1: Monitor & Tune

- –°–æ–±—Ä–∞—Ç—å feedback –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å thresholds –¥–ª—è detail levels

### Week 2: External Integrations

- –í–∫–ª—é—á–∏—Ç—å Crawl4AI –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Å—ã–ª–æ–∫
- –í–∫–ª—é—á–∏—Ç—å Searxng –¥–ª—è topic research
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å comprehensive level

### Week 3: Neo4j Knowledge Graph

- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤ –≤ –≥—Ä–∞—Ñ
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –¥–∏—Å–∫—É—Å—Å–∏–π
- –î–æ–±–∞–≤–∏—Ç—å –≤ comprehensive level

---

## Quick Test Scenarios

### Scenario 1: Casual Chat (Micro)

**Setup:** –ì—Ä—É–ø–ø–∞ —Å 2-3 —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —á–∞—Å–∞

**Expected:**
- Detail level: micro
- Format: –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ + —ç–º–æ–¥–∑–∏
- Time: <10s

### Scenario 2: Work Discussion (Standard)

**Setup:** –†–∞–±–æ—á–∞—è –≥—Ä—É–ø–ø–∞ —Å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ–º –∑–∞–¥–∞—á (20-30 —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ 12—á)

**Expected:**
- Detail level: standard
- Format: —Ç–µ–º—ã + —É—á–∞—Å—Ç–Ω–∏–∫–∏ + –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã + —ç–º–æ—Ü–∏–∏
- Time: <50s
- –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω—ã

### Scenario 3: Long Meeting (Detailed)

**Setup:** –ê–∫—Ç–∏–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞ —Å –¥–æ–ª–≥–∏–º –æ–±—Å—É–∂–¥–µ–Ω–∏–µ–º (60+ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ 24—á)

**Expected:**
- Detail level: detailed
- Format: + —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è + —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞
- Time: <90s
- Timeline –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ Ready for Testing  
**Next:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å checklist  
**Documentation:** See IMPLEMENTATION_SUMMARY_2025-10-14.md

