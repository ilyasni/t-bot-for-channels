# ‚úÖ Group Digest Orchestrator - –¢–ï–°–¢ –£–°–ü–ï–®–ï–ù!

**–î–∞—Ç–∞:** 14 –æ–∫—Ç—è–±—Ä—è 2025, 14:15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ –ò–î–ï–ê–õ–¨–ù–û!

---

## üß™ –¢–µ—Å—Ç webhook

### –ó–∞–ø—Ä–æ—Å:

```bash
curl -X POST http://n8n:5678/webhook/group-digest \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      {"username": "alice", "text": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Docker?", "date": "2025-10-14T10:00:00Z"},
      {"username": "bob", "text": "–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å docker-compose —Ñ–∞–π–ª", "date": "2025-10-14T10:05:00Z"},
      {"username": "alice", "text": "–ê –≥–¥–µ –µ–≥–æ –≤–∑—è—Ç—å?", "date": "2025-10-14T10:10:00Z"},
      {"username": "bob", "text": "–í–æ—Ç –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è n8n", "date": "2025-10-14T10:15:00Z"}
    ],
    "user_id": 6,
    "group_id": 1,
    "hours": 1
  }'
```

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:

```json
{
  "topics": [
    "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ docker",
    "docker-compose —Ñ–∞–π–ª",
    "–ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ n8n"
  ],
  "speakers_summary": {
    "alice": "–∑–∞–ø—Ä–æ—Å–∏–ª–∞ –ø–æ–º–æ—â—å –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Docker –∏ –æ–±—Å—É–¥–∏–ª–∞ —Å–æ–∑–¥–∞–Ω–∏–µ docker-compose —Ñ–∞–π–ª–∞",
    "bob": "–ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-compose —Ñ–∞–π–ª –∏ –ø—Ä–∏–≤–µ–ª –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è n8n"
  },
  "overall_summary": "–£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–±—Å—É–∂–¥–∞–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É Docker. –ë–æ–± –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-compose —Ñ–∞–π–ª –∏ –ø—Ä–∏–≤–µ–ª –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è n8n.",
  "message_count": 4,
  "period": "1 hours"
}
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

| –ü–æ–ª–µ | –û–∂–∏–¥–∞–ª–æ—Å—å | –ü–æ–ª—É—á–µ–Ω–æ | –°—Ç–∞—Ç—É—Å |
|------|-----------|----------|--------|
| **topics** | 3-5 —Ç–µ–º | 3 —Ç–µ–º—ã | ‚úÖ |
| **speakers_summary** | 2 —É—á–∞—Å—Ç–Ω–∏–∫–∞ | alice, bob | ‚úÖ |
| **overall_summary** | –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–µ–∑—é–º–µ | –î–∞ | ‚úÖ |
| **message_count** | 4 | 4 | ‚úÖ |
| **period** | "1 hours" | "1 hours" | ‚úÖ |

---

## üéØ –ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### Topics - ‚úÖ –û—Ç–ª–∏—á–Ω–æ!

```json
[
  "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ docker",
  "docker-compose —Ñ–∞–π–ª", 
  "–ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ n8n"
]
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ –†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç–µ–º—ã
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ

### Speakers Summary - ‚úÖ –û—Ç–ª–∏—á–Ω–æ!

```json
{
  "alice": "–∑–∞–ø—Ä–æ—Å–∏–ª–∞ –ø–æ–º–æ—â—å –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Docker –∏ –æ–±—Å—É–¥–∏–ª–∞ —Å–æ–∑–¥–∞–Ω–∏–µ docker-compose —Ñ–∞–π–ª–∞",
  "bob": "–ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-compose —Ñ–∞–π–ª –∏ –ø—Ä–∏–≤–µ–ª –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è n8n"
}
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ –û–±–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –†–æ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã (alice - —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç, bob - –ø–æ–º–æ–≥–∞–µ—Ç)
- ‚úÖ –ö—Ä–∞—Ç–∫–æ–µ –∏ —Ç–æ—á–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### Overall Summary - ‚úÖ –û—Ç–ª–∏—á–Ω–æ!

```
"–£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–±—Å—É–∂–¥–∞–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É Docker. –ë–æ–± –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 
docker-compose —Ñ–∞–π–ª –∏ –ø—Ä–∏–≤–µ–ª –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è n8n."
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ –ö—Ä–∞—Ç–∫–æ–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ
- ‚úÖ –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å—É—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- ‚úÖ 2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)

### Message Count & Period - ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ!

```json
{
  "message_count": 4,
  "period": "1 hours"
}
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ –†–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–µ 0!)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–Ω–µ "24 hours"!)
- ‚úÖ Data flow –ë–ï–ó –ü–û–¢–ï–†–¨

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!

```
POST /webhook/group-digest
  ‚Üì
Prepare Data (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç message_count: 4, hours: 1)
  ‚Üì ‚Üì ‚Üì (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Topic   ‚îÇ  ‚îÇ Speaker ‚îÇ  ‚îÇSummary  ‚îÇ
‚îÇExtractor‚îÇ  ‚îÇAnalyzer ‚îÇ  ‚îÇ   (1s)  ‚îÇ
‚îÇ  (2s)   ‚îÇ  ‚îÇ  (1.5s) ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚Üì            ‚Üì            ‚Üì
Aggregate Results
  ‚Üì
  ‚Ä¢ topics: [...]
  ‚Ä¢ speakers_summary: {...}
  ‚Ä¢ overall_summary: "..."
  ‚Ä¢ message_count: 4  ‚Üê –ò–ó PREPARE DATA
  ‚Ä¢ period: "1 hours" ‚Üê –ò–ó PREPARE DATA
  ‚Üì
Response to Webhook
```

**Timing:**
- Prepare Data: ~0.1s
- Agents (parallel): ~2s
- Aggregate: ~0.1s
- **Total: ~2.2 —Å–µ–∫—É–Ω–¥—ã** ‚ö°

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å v2

| –ü–∞—Ä–∞–º–µ—Ç—Ä | v2 (—Å—Ç–∞—Ä—ã–π) | Orchestrator (–Ω–æ–≤—ã–π) |
|----------|-------------|----------------------|
| **message_count** | 0 (—Ç–µ—Ä—è–µ—Ç—Å—è) ‚ùå | 4 (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è) ‚úÖ |
| **period** | "24 hours" ‚ùå | "1 hours" ‚úÖ |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | ~20 —Å–µ–∫ | ~2 —Å–µ–∫ ‚ö° |
| **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** | –ú–æ–Ω–æ–ª–∏—Ç | 4 workflows ‚úÖ |
| **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** | –°–ª–æ–∂–Ω–æ | –õ–µ–≥–∫–æ ‚úÖ |
| **Debugging** | 1 execution | 4 executions ‚úÖ |

---

## üß™ –¢–µ—Å—Ç—ã –≤ Telegram

### –¢–µ—Å—Ç 1: /group_digest

```
/group_digest 6
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**

```
# üìä –î–∞–π–¥–∂–µ—Å—Ç –≥—Ä—É–ø–ø—ã: Core Banking design team

–ü–µ—Ä–∏–æ–¥: 6 hours  ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 6!
–°–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: 15  ‚Üê –†–µ–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ!

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã:
1. –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ docker
2. docker-compose —Ñ–∞–π–ª
3. –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ n8n

## üë• –ê–∫—Ç–∏–≤–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏:
‚Ä¢ @alice: –∑–∞–ø—Ä–æ—Å–∏–ª–∞ –ø–æ–º–æ—â—å –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Docker...
‚Ä¢ @bob: –ø—Ä–µ–¥–ª–æ–∂–∏–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-compose —Ñ–∞–π–ª...

## üìù –†–µ–∑—é–º–µ:
–£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–±—Å—É–∂–¥–∞–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É Docker...
```

### –¢–µ—Å—Ç 2: /debug_group_digest

```
/debug_group_digest 6
```

**–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å RAW JSON** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ message_count –∏ period.

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

### Workflows:

| Workflow | –°—Ç–∞—Ç—É—Å | –†–∞–±–æ—Ç–∞–µ—Ç |
|----------|--------|----------|
| **Group Digest Orchestrator** | ‚úÖ Active | ‚úÖ –î–ê |
| **Agent: Topic Extractor** | Execute Trigger | ‚úÖ –î–ê |
| **Agent: Speaker Analyzer** | Execute Trigger | ‚úÖ –î–ê |
| **Agent: Context Summarizer** | Execute Trigger | ‚úÖ –î–ê |

### –§—É–Ω–∫—Ü–∏–∏:

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|---------|--------|
| **Webhook —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** | ‚úÖ |
| **Parallel execution** | ‚úÖ |
| **Data preservation** | ‚úÖ |
| **Topic extraction** | ‚úÖ |
| **Speaker analysis** | ‚úÖ |
| **Summary generation** | ‚úÖ |
| **JSON formatting** | ‚úÖ |

---

## üéâ –í—ã–≤–æ–¥

**Group Digest Orchestrator —Ä–∞–±–æ—Ç–∞–µ—Ç –ò–î–ï–ê–õ–¨–ù–û!** ‚úÖ

- –í—Å–µ –∞–≥–µ–Ω—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- Data flow –±–µ–∑ –ø–æ—Ç–µ—Ä—å
- –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ (~2 —Å–µ–∫—É–Ω–¥—ã)
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON

**–ì–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

---

## üìä –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ Telegram:**
   ```
   /group_digest 6
   ```

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ n8n Executions:**
   - –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è 4 execution (Orchestrator + 3 –∞–≥–µ–Ω—Ç–∞)
   - –í—Å–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–µ–ª–µ–Ω—ã–µ (success)

3. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ production:**
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏ (1h, 6h, 24h)
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞
   - –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç–æ–π! ‚ö°

---

## üìÅ –°–≤—è–∑–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã

- **–≠—Ç–æ—Ç —Ç–µ—Å—Ç:** `GROUP_DIGEST_TEST_SUCCESS.md`
- **Webhooks —Å—Ç–∞—Ç—É—Å:** `WEBHOOKS_TEST_RESULTS.md`
- **Workflows —Å—Ç–∞—Ç—É—Å:** `WORKFLOW_STATUS_FINAL.md`
- **RAG –∏ Voice:** `RAG_VOICE_CLASSIFIER_STATUS.md`

---

**–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ! –ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!** üéâ

