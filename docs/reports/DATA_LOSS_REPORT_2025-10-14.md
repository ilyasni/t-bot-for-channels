# üö® –û—Ç—á–µ—Ç –æ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö n8n - 14.10.2025

## ‚ùå –†–µ–∑—é–º–µ

**–î–∞–Ω–Ω—ã–µ n8n (workflows, credentials, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏) –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ –ø–æ—Ç–µ—Ä—è–Ω—ã.**

---

## üìä –§–∞–∫—Ç—ã

### –ß—Ç–æ –ø–æ—Ç–µ—Ä—è–Ω–æ:

- ‚úÖ –í—Å–µ workflows (–≤–∫–ª—é—á–∞—è Voice Command Classifier, Group Digest, –∏ –¥—Ä.)
- ‚úÖ –í—Å–µ credentials (API –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã)
- ‚úÖ –í—Å–µ executions (–∏—Å—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ n8n

### –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å:

- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (docker-compose.yml, .env)
- ‚úÖ –ö–æ–¥ Telegram Bot (telethon/)
- ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ workflows (n8n/backup/workflows/)
- ‚úÖ Supabase –ë–î (–µ—Å–ª–∏ —Ç–∞–º –±—ã–ª–∏ –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ Qdrant –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î
- ‚úÖ Redis –∫–µ—à

---

## üïê –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Å–æ–±—ã—Ç–∏–π

```
06.10.2025 22:55:09  ‚Üê –°–æ–∑–¥–∞–Ω—ã volumes n8n-installer_*
13.10.2025 22:35:00  ‚Üê –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ n8n (—Ä–∞–±–æ—Ç–∞–ª–∏ workflows)
14.10.2025 00:49:00  ‚Üê –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥–æ–≤ (.backups/pre-update-20251014-004900/)
14.10.2025 07:50:28  ‚Üê PostgreSQL –ü–ï–†–ï–°–û–ó–î–ê–ù (localai_langfuse_postgres_data)
14.10.2025 10:50:28  ‚Üê –°–æ–∑–¥–∞–Ω—ã volumes localai_* (–ù–û–í–´–ï –ü–£–°–¢–´–ï)
14.10.2025 11:00:00  ‚Üê –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö
```

---

## üîç –ü—Ä–∏—á–∏–Ω–∞

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ **—Å–º–µ–Ω–∞ –ø—Ä–µ—Ñ–∏–∫—Å–∞ Docker Compose –ø—Ä–æ–µ–∫—Ç–∞**:

```bash
# –î–û –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
n8n-installer_langfuse_postgres_data  # –°—Ç–∞—Ä—ã–π volume —Å –¥–∞–Ω–Ω—ã–º–∏

# –ü–û–°–õ–ï –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
localai_langfuse_postgres_data        # –ù–æ–≤—ã–π –ü–£–°–¢–û–ô volume
```

**Docker Compose —Å–æ–∑–¥–∞–ª –Ω–æ–≤—ã–µ volumes –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö.**

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã —Å–º–µ–Ω—ã –ø—Ä–µ—Ñ–∏–∫—Å–∞:

1. –ó–∞–ø—É—Å–∫ `docker-compose` –∏–∑ –¥—Ä—É–≥–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
2. –°–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `COMPOSE_PROJECT_NAME` –≤ .env
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–ª–∞–≥–∞ `-p` –∏–ª–∏ `--project-name`
4. –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥—ã —Ç–∏–ø–∞ `docker-compose -f localai/docker-compose.yml up`

---

## üîé –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### ‚ùå –ù–ï –ù–ê–ô–î–ï–ù–û:

1. **SQL –¥–∞–º–ø—ã PostgreSQL:**
   ```bash
   find /home/ilyasni/n8n-server/ -name "*.sql*" -o -name "*dump*"
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–£–°–¢–û
   ```

2. **–°—Ç–∞—Ä—ã–π PostgreSQL volume:**
   ```bash
   docker volume ls | grep postgres
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ª—å–∫–æ localai_langfuse_postgres_data (–Ω–æ–≤—ã–π)
   ```

3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ workflows –≤ Git:**
   ```bash
   git log --grep="Voice Command\|Group Digest"
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: –ù–ï–¢ –∫–æ–º–º–∏—Ç–æ–≤ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ workflows
   ```

4. **–≠–∫—Å–ø–æ—Ä—Ç—ã –∏–∑ n8n UI:**
   ```bash
   find ~ -name "*.json" -path "*Download*" -mtime -30
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ª—å–∫–æ –¥–µ–º–æ workflows
   ```

5. **Dangling volumes:**
   ```bash
   docker volume ls -f dangling=true
   # –†–µ–∑—É–ª—å—Ç–∞—Ç: 4 –ø—É—Å—Ç—ã—Ö volume –ø–æ 4KB –∫–∞–∂–¥—ã–π
   ```

### ‚úÖ –ß–¢–û –ï–°–¢–¨:

- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ workflows (310 —à—Ç.) –≤ `n8n/backup/workflows/`
- –ë—ç–∫–∞–ø—ã –∫–æ–Ω—Ñ–∏–≥–æ–≤ –≤ `.backups/pre-update-20251014-004900/`
- –ü—É—Å—Ç–∞—è PostgreSQL –ë–î —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ç–∞–±–ª–∏—Ü

---

## üìã –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

```bash
PostgreSQL volume: localai_langfuse_postgres_data
–°–æ–∑–¥–∞–Ω: 2025-10-14T10:50:28+03:00
–†–∞–∑–º–µ—Ä: 65 MB (–ø—É—Å—Ç–∞—è –ë–î —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Ç–∞–±–ª–∏—Ü)

Workflows: 0
Credentials: 0  
Executions: 0
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 1 (–±–µ–∑ email - –ø—É—Å—Ç–æ–π)
```

---

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞:

```bash
./scripts/backup-n8n-postgres.sh       # –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
./scripts/restore-n8n-postgres.sh      # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
./scripts/inspect-volume.sh            # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ volume
```

### 2. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- `DATA_LOSS_PREVENTION.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—é –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

### 3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–±—ç–∫–∞–ø–æ–≤:

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ crontab (–±—ç–∫–∞–ø –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00):
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å:
0 3 * * * /home/ilyasni/n8n-server/n8n-installer/scripts/backup-n8n-postgres.sh >> /home/ilyasni/n8n-server/n8n-installer/.backups/postgres/backup.log 2>&1
```

---

## üéØ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–∞—á–∞—Ç—å —Å –Ω—É–ª—è ‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–±—ç–∫–∞–ø—ã
crontab -e
# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
0 3 * * * /home/ilyasni/n8n-server/n8n-installer/scripts/backup-n8n-postgres.sh >> /home/ilyasni/n8n-server/n8n-installer/.backups/postgres/backup.log 2>&1

# 2. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è n8n
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5678 –∏–ª–∏ https://–≤–∞—à-–¥–æ–º–µ–Ω

# 3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å workflows –≤—Ä—É—á–Ω—É—é
# (–∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ—Ç –¥—Ä—É–≥–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)

# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç workflows –≤ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
# Settings ‚Üí Import/Export ‚Üí Enable Git sync
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –Ω–∞–π—Ç–∏ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ volumes –¥–µ—Ç–∞–ª—å–Ω–æ
docker volume ls -q | while read vol; do
    echo "=== $vol ==="
    ./scripts/inspect-volume.sh "$vol"
done > all-volumes-inspection.txt

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å backups –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤–Ω–µ—à–Ω–∏–µ –±—ç–∫–∞–ø—ã)
# ...

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å snapshots (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LVM/ZFS/Btrfs)
# ...
```

---

## üõ°Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ü–ï–†–ï–î —Å–ª–µ–¥—É—é—â–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

### ‚úÖ Checklist:

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø PostgreSQL
./scripts/backup-n8n-postgres.sh

# 2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å workflows –∏–∑ UI
# n8n ‚Üí Settings ‚Üí Import/Export ‚Üí Export all workflows

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±—ç–∫–∞–ø
ls -lh .backups/postgres/ | tail -5

# 4. –ó–∞–ø–∏—Å–∞—Ç—å –∏–º–µ–Ω–∞ —Ç–µ–∫—É—â–∏—Ö volumes
docker volume ls > volumes-before-update.txt

# 5. –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
# ‚ùå docker-compose down -v
# ‚ùå docker volume prune --all
```

---

## üìû –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–î–∞—Ç–∞ –ø–æ—Ç–µ—Ä–∏:** 14.10.2025  
**–í—Ä–µ–º—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:** ~11:00 MSK  
**–ü—Ä–∏—á–∏–Ω–∞:** –°–º–µ–Ω–∞ Docker Compose –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí –Ω–æ–≤—ã–µ volumes  
**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ù–ï–í–û–ó–ú–û–ñ–ù–û (–Ω–µ—Ç –±—ç–∫–∞–ø–æ–≤)  
**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—á–∞—Ç—å —Å –Ω—É–ª—è + –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–±—ç–∫–∞–ø—ã

---

**–§–∞–π–ª —Å–æ–∑–¥–∞–Ω:** 14.10.2025  
**–ê–≤—Ç–æ—Ä:** AI Assistant

