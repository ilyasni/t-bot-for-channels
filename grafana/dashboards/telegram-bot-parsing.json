{
  "title": "Telegram Bot - Parsing Metrics",
  "uid": "telegram-bot-parsing",
  "tags": ["telegram-bot", "parsing"],
  "timezone": "browser",
  "schemaVersion": 38,
  "version": 1,
  "refresh": "30s",
  "panels": [
      {
        "id": 1,
        "title": "Parsing Queue Size",
        "type": "timeseries",
        "gridPos": {"x": 0, "y": 0, "w": 12, "h": 8},
        "targets": [
          {
            "expr": "bot_parsing_queue_size",
            "legendFormat": "Queue Size",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": null, "color": "green"},
                {"value": 5, "color": "yellow"},
                {"value": 10, "color": "red"}
              ]
            },
            "custom": {
              "fillOpacity": 20
            }
          }
        },
        "options": {
          "legend": {
            "displayMode": "list",
            "placement": "bottom"
          }
        }
      },
      {
        "id": 2,
        "title": "Posts Parsed Rate",
        "type": "timeseries",
        "gridPos": {"x": 12, "y": 0, "w": 12, "h": 8},
        "targets": [
          {
            "expr": "sum(rate(bot_posts_parsed_total[5m]))",
            "legendFormat": "Total Posts/sec",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "ops",
            "custom": {
              "fillOpacity": 10
            }
          }
        }
      },
      {
        "id": 3,
        "title": "Posts Parsed by User (Top 10)",
        "type": "timeseries",
        "gridPos": {"x": 0, "y": 8, "w": 12, "h": 8},
        "targets": [
          {
            "expr": "topk(10, sum(rate(bot_posts_parsed_total[5m])) by (user_id))",
            "legendFormat": "User {{user_id}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "ops",
            "custom": {
              "fillOpacity": 10
            }
          }
        },
        "options": {
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "calcs": ["mean", "lastNotNull", "sum"]
          }
        }
      },
      {
        "id": 4,
        "title": "Total Posts Parsed",
        "type": "stat",
        "gridPos": {"x": 12, "y": 8, "w": 6, "h": 4},
        "targets": [
          {
            "expr": "sum(bot_posts_parsed_total)",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "color": {"mode": "palette-classic"}
          }
        }
      },
      {
        "id": 5,
        "title": "Average Queue Size",
        "type": "stat",
        "gridPos": {"x": 18, "y": 8, "w": 6, "h": 4},
        "targets": [
          {
            "expr": "avg_over_time(bot_parsing_queue_size[5m])",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": null, "color": "green"},
                {"value": 3, "color": "yellow"},
                {"value": 7, "color": "red"}
              ]
            }
          }
        },
        "options": {
          "graphMode": "area"
        }
      },
      {
        "id": 6,
        "title": "Posts Parsed per User",
        "type": "bargauge",
        "gridPos": {"x": 12, "y": 12, "w": 12, "h": 8},
        "targets": [
          {
            "expr": "sum(bot_posts_parsed_total) by (user_id)",
            "legendFormat": "User {{user_id}}",
            "refId": "A"
          }
        ],
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "showUnfilled": true
        },
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "max": null,
            "min": 0
          }
        }
      }
    ]
}

