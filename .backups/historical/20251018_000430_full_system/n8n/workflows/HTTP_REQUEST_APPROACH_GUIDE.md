# HTTP Request Approach Guide

## –û–±–∑–æ—Ä

–í—Å–µ –∞–≥–µ–Ω—Ç—ã n8n workflows –±—ã–ª–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `n8n-nodes-gigachat` –Ω–∞ –ø—Ä—è–º–æ–π HTTP Request –∫ `gpt2giga-proxy`. –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ü—Ä—è–º–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏
- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞ —Å `gpt2giga-proxy` –±–µ–∑ –ø—Ä–æ–±–ª–µ–º —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ **JSON Mode**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `response_format: {"type": "json_object"}`
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `Utility: JSON Guardrail`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ö–µ–º–∞ –∞–≥–µ–Ω—Ç–∞

```
Execute Workflow Trigger
    ‚Üì
Prepare [Agent] Prompt (Code)
    ‚Üì
GigaChat: [Agent] (HTTP Request)
    ‚Üì
Parse Response (Code)
    ‚Üì
Execute Guardrail
    ‚Üì
[Output/Next Agent]
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. Prepare [Agent] Prompt (Code Node)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –§–æ—Ä–º–∏—Ä—É–µ—Ç `system_message` –∏ `user_message` –¥–ª—è HTTP Request
- **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ + –∏—Å—Ö–æ–¥–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: `{system_message, user_message, max_tokens, ...}`

#### 2. GigaChat: [Agent] (HTTP Request Node)
- **URL**: `http://gpt2giga-proxy:8000/v1/chat/completions`
- **Method**: POST
- **Headers**: `Content-Type: application/json`
- **Body**: JSON —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ GigaChat API

#### 3. Parse Response (Code Node)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ò–∑–≤–ª–µ–∫–∞–µ—Ç `content` –∏–∑ `choices[0].message.content`
- **–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: `{raw_content: "..."}`

#### 4. Execute Guardrail
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–∞—Ä—Å–∏–Ω–≥ JSON –æ—Ç–≤–µ—Ç–∞
- **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: `raw_content` –æ—Ç Parse Response

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è HTTP Request

### –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```json
{
  "url": "http://gpt2giga-proxy:8000/v1/chat/completions",
  "authentication": "none",
  "requestMethod": "POST",
  "sendHeaders": true,
  "headerParameters": {
    "parameters": [
      {
        "name": "Content-Type",
        "value": "application/json"
      }
    ]
  },
  "sendBody": true,
  "bodyContentType": "json",
  "jsonBody": "={{ {\"model\": \"GigaChat-Pro\", \"messages\": [{\"role\": \"system\", \"content\": $json.system_message}, {\"role\": \"user\", \"content\": $json.user_message}], \"temperature\": 0.1, \"max_tokens\": $json.max_tokens, \"response_format\": {\"type\": \"json_object\"}} }}",
  "options": {}
}
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **Model**: `GigaChat-Pro` (—á–µ—Ä–µ–∑ gpt2giga-proxy)
- **Temperature**: `0.1` (–Ω–∏–∑–∫–∞—è —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å)
- **Response Format**: `{"type": "json_object"}` (—Å—Ç—Ä–æ–≥–∏–π JSON)
- **Max Tokens**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑ `$json.max_tokens`

## –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

1. **Agent: Dialogue Assessor** ‚Üí Code node —Å —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º–∏
2. **Agent: Speaker Analyzer** ‚Üí HTTP Request + Parse Response
3. **Agent: Supervisor Synthesizer** ‚Üí HTTP Request + Parse Response  
4. **Agent: Topic Extractor** ‚Üí HTTP Request + Parse Response
5. **Agent: Emotion Analyzer** ‚Üí HTTP Request + Parse Response
6. **Agent: Key Moments** ‚Üí HTTP Request + Parse Response
7. **Agent: Timeline** ‚Üí HTTP Request + Parse Response
8. **Agent: Summarizer** ‚Üí HTTP Request + Parse Response
9. **Agent: Context Links** ‚Üí HTTP Request + Parse Response

### üîß Utility: JSON Guardrail

–û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `gpt2giga-proxy`:
- –£–±—Ä–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞–≤—ã—á–µ–∫
- –û–∂–∏–¥–∞–µ—Ç—Å—è —á–∏—Å—Ç—ã–π JSON –æ—Ç –ø—Ä–æ–∫—Å–∏
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### 1. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- –ü—Ä—è–º–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ HTTP –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –æ—Ç–≤–µ—Ç–æ–≤ GigaChat node
- –ß–µ—Ç–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ù–∏–∑–∫–∞—è temperature (0.1) –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- JSON Mode –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ token budgets

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π Guardrail –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è JSON
- Fallback –Ω–∞ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### 4. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∞–≥–µ–Ω—Ç—ã
- –ü—Ä–æ—Å—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å GigaChat Node

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|-----------|------|-------|
| **API Call** | `n8n-nodes-gigachat.gigaChat` | `n8n-nodes-base.httpRequest` |
| **Prompt** | –ü—Ä—è–º–æ –≤ GigaChat node | –û—Ç–¥–µ–ª—å–Ω—ã–π Code node |
| **Response** | `$json.response` | `$json.choices[0].message.content` |
| **Validation** | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è | –ß–µ—Ä–µ–∑ Guardrail sub-workflow |

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞–µ—Ç —Å gpt2giga-proxy
- ‚úÖ **JSON Mode**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `response_format`
- ‚úÖ **–ö–æ–Ω—Ç—Ä–æ–ª—å**: –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ **–û—Ç–ª–∞–¥–∫–∞**: –õ—É—á—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞

1. **–ò–º–ø–æ—Ä—Ç workflow** –≤ n8n
2. **–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫** —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤** Guardrail
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è JSON** –æ—Ç–≤–µ—Ç–æ–≤

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- ‚úÖ –ß–∏—Å—Ç—ã–π JSON –±–µ–∑ markdown –±–ª–æ–∫–æ–≤
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ @user1, @user2)
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞–≤—ã—á–µ–∫

## Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **JSON Parse Error**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Guardrail
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ `response_format`

2. **Empty Response**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å gpt2giga-proxy
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã HTTP Request

3. **Invalid JSON Structure**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã –≤ Prepare Prompt node
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ system_message

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

- **Prepare Prompt**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ system_message/user_message
- **HTTP Request**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- **Parse Response**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ content
- **Guardrail**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é JSON

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

HTTP Request –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Å gpt2giga-proxy, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JSON Mode –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤. –í—Å–µ –∞–≥–µ–Ω—Ç—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Guardrail.
