# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–π–¥–∂–µ—Å—Ç?

**–î–∞—Ç–∞:** 11 –æ–∫—Ç—è–±—Ä—è 2025  
**–§–∞–π–ª:** `rag_service/digest_generator.py`

---

## ‚ùì –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ LLM –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–π–¥–∂–µ—Å—Ç–∞?

### ‚ùå –ù–ï–¢! –î–∞–π–¥–∂–µ—Å—Ç –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç AI/LLM

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ **—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ—Å—Ç–æ–≤
- ‚úÖ –ë–µ–∑ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ë–µ–∑ –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ –ë–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞

**–ù–∏–∫–∞–∫–∞—è –º–æ–¥–µ–ª—å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GigaChat
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenRouter
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è RAG-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è

---

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–π–¥–∂–µ—Å—Ç (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

```python
1. –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç—ã –∑–∞ –ø–µ—Ä–∏–æ–¥ (date_from ‚Üí date_to)
   ‚Üì
2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   - –ü–æ –∫–∞–Ω–∞–ª–∞–º (channels)
   - –ü–æ —Ç–µ–≥–∞–º (tags)
   ‚Üì
3. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
   ‚Üì
4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ (max_posts, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 200)
   ‚Üì
5. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞–Ω–∞–ª–∞–º
   ‚Üì
6. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Markdown/HTML/Plain)
   ‚Üì
7. –í–æ–∑–≤—Ä–∞—Ç –≥–æ—Ç–æ–≤–æ–≥–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –¥–∞–π–¥–∂–µ—Å—Ç

**–®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤**
```sql
SELECT * FROM posts 
WHERE user_id = 6 
  AND posted_at >= '2025-10-11 00:00:00'
  AND posted_at <= '2025-10-11 23:59:59'
ORDER BY posted_at DESC
LIMIT 200
```

**–®–∞–≥ 2: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞–Ω–∞–ª–∞–º**
```python
posts_by_channel = {
    "banksta": [post1, post2, post3, ...],
    "tech_news": [post4, post5, ...]
}
```

**–®–∞–≥ 3: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Markdown)**
```markdown
# üì∞ –î–∞–π–¥–∂–µ—Å—Ç –ø–æ—Å—Ç–æ–≤
**–ü–µ—Ä–∏–æ–¥:** 11.10.2025 - 11.10.2025

## üì¢ @banksta
*–ü–æ—Å—Ç–æ–≤: 12*

### 11.10.2025 12:19 | `–±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã`, `—Ü–µ–Ω—ã`, `–ø–∞–¥–µ–Ω–∏–µ —Ü–µ–Ω`
–¶–µ–Ω—ã –Ω–∞ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –ø–∞–¥–∞—Ç—å —É–∂–µ —Ç—Ä–µ—Ç–∏–π –≥–æ–¥...
[–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Üí](https://t.me/banksta/79979)

### 11.10.2025 11:51 | `—Ç–æ—Ä–≥–æ–≤—ã–π —Ñ–ª–æ—Ç`, `–∏–Ω–¥–æ–Ω–µ–∑–∏—è`
–ö—Ä—É–ø–Ω–µ–π—à–∏–º —Ç–æ—Ä–≥–æ–≤—ã–º —Ñ–ª–æ—Ç–æ–º –º–∏—Ä–∞...
[–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Üí](https://t.me/banksta/79978)
```

**–ì–æ—Ç–æ–≤–æ!** –ù–∏–∫–∞–∫–æ–π AI/LLM –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞

### Markdown (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```markdown
# üì∞ –î–∞–π–¥–∂–µ—Å—Ç –ø–æ—Å—Ç–æ–≤
**–ü–µ—Ä–∏–æ–¥:** DD.MM.YYYY - DD.MM.YYYY

## üì¢ @channel_name
*–ü–æ—Å—Ç–æ–≤: N*

### DD.MM.YYYY HH:MM | `tag1`, `tag2`
[–ü–µ—Ä–≤—ã–µ 300 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–∞]...
[–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Üí](—Å—Å—ã–ª–∫–∞)

### DD.MM.YYYY HH:MM | `tag3`
[–ï—â–µ –æ–¥–∏–Ω –ø–æ—Å—Ç]...
```

### HTML

```html
<html><body>
<h1>üì∞ –î–∞–π–¥–∂–µ—Å—Ç –ø–æ—Å—Ç–æ–≤</h1>
<p><b>–ü–µ—Ä–∏–æ–¥:</b> DD.MM.YYYY - DD.MM.YYYY</p>

<h2>üì¢ @channel_name</h2>
<p><i>–ü–æ—Å—Ç–æ–≤: N</i></p>

<div style='margin-bottom: 20px;'>
  <h3>DD.MM.YYYY HH:MM</h3>
  <p>[–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞]</p>
  <a href='—Å—Å—ã–ª–∫–∞'>–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Üí</a>
</div>
</body></html>
```

### Plain Text

```
============================================================
–î–ê–ô–î–ñ–ï–°–¢ –ü–û–°–¢–û–í
–ü–µ—Ä–∏–æ–¥: DD.MM.YYYY - DD.MM.YYYY
============================================================

@channel_name (N –ø–æ—Å—Ç–æ–≤)
------------------------------------------------------------
DD.MM.YYYY HH:MM
[–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞]
–°—Å—ã–ª–∫–∞: https://...

DD.MM.YYYY HH:MM
[–ï—â–µ –æ–¥–∏–Ω –ø–æ—Å—Ç]
```

---

## üéõÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞–π–¥–∂–µ—Å—Ç–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ

```python
{
  "user_id": 6,                    # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  "date_from": "2025-10-11T00:00:00Z",  # –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞
  "date_to": "2025-10-11T23:59:59Z"     # –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞
}
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ

```python
{
  "channels": [1, 2, 3],           # –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞–Ω–∞–ª–∞–º (None = –≤—Å–µ)
  "tags": ["–±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã", "–∫—Ä–∏–ø—Ç–∞"], # –§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º (None = –≤—Å–µ)
  "format": "markdown",            # markdown/html/plain
  "max_posts": 200                 # –õ–∏–º–∏—Ç –ø–æ—Å—Ç–æ–≤ (1-500)
}
```

---

## üìù –ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –¥–∞–π–¥–∂–µ—Å—Ç

### –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞:

1. **–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è** (`posted_at`)
   ```
   11.10.2025 12:19
   ```

2. **–¢–µ–≥–∏** (–ø–µ—Ä–≤—ã–µ 3)
   ```
   `–±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã`, `—Ü–µ–Ω—ã`, `–ø–∞–¥–µ–Ω–∏–µ —Ü–µ–Ω`
   ```

3. **–¢–µ–∫—Å—Ç** (–ø–µ—Ä–≤—ã–µ 300 —Å–∏–º–≤–æ–ª–æ–≤)
   ```
   –¶–µ–Ω—ã –Ω–∞ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –ø–∞–¥–∞—Ç—å —É–∂–µ —Ç—Ä–µ—Ç–∏–π –≥–æ–¥. 
   –í —Å–µ–Ω—Ç—è–±—Ä–µ –æ–Ω–∏ —Å–Ω–∏–∂–∞–ª–∏—Å—å –Ω–∞ —Ñ–æ–Ω–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –≤–æ–∫—Ä—É–≥ 
   –ø—Ä–æ–¥–∞–∂–∏ De Beers –∏ –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏—Ö —Ç–∞—Ä–∏—Ñ–æ–≤, —Å–æ–æ–±—â–∞–µ—Ç Rapaport...
   ```

4. **–°—Å—ã–ª–∫–∞** –Ω–∞ –ø–æ–ª–Ω—ã–π –ø–æ—Å—Ç
   ```
   [–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Üí](https://t.me/banksta/79979)
   ```

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞

- –ü–æ—Å—Ç—ã –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è **–ø–æ –∫–∞–Ω–∞–ª–∞–º**
- –í–Ω—É—Ç—Ä–∏ –∫–∞–Ω–∞–ª–∞ **—Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –¥–∞—Ç–µ** (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞

---

## üÜö –î–∞–π–¥–∂–µ—Å—Ç vs RAG-–æ—Ç–≤–µ—Ç

### –î–∞–π–¥–∂–µ—Å—Ç (–±–µ–∑ AI)

```markdown
‚úÖ –ü—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤
‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞–Ω–∞–ª–∞–º
‚úÖ –•—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫
‚úÖ –ü–µ—Ä–≤—ã–µ 300 —Å–∏–º–≤–æ–ª–æ–≤ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞
‚úÖ –°—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ª–Ω—ã–µ –ø–æ—Å—Ç—ã
‚ùå –ë–ï–ó —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏
‚ùå –ë–ï–ó –∞–Ω–∞–ª–∏–∑–∞
‚ùå –ë–ï–ó –≤—ã–≤–æ–¥–æ–≤
```

**–ü—Ä–∏–º–µ—Ä:**
```
12 –ø–æ—Å—Ç–æ–≤ –æ—Ç @banksta –∑–∞ 11.10.2025
–ü–æ—Å—Ç 1: –¶–µ–Ω—ã –Ω–∞ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã...
–ü–æ—Å—Ç 2: –ö—Ä–∏–ø—Ç–æ—Ä—ã–Ω–æ–∫ –æ–±–≤–∞–ª–∏–ª—Å—è...
–ü–æ—Å—Ç 3: –¢–æ—Ä–≥–æ–≤—ã–π —Ñ–ª–æ—Ç...
```

### RAG-–æ—Ç–≤–µ—Ç (—Å AI - GigaChat)

```markdown
‚úÖ –ê–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ—Å—Ç–æ–≤
‚úÖ –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
‚úÖ –í—ã–≤–æ–¥—ã –∏ —Ç—Ä–µ–Ω–¥—ã
‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
‚úÖ –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ
```

**–ü—Ä–∏–º–µ—Ä:**
```
–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Å—Ç–æ–≤:
- –†—ã–Ω–æ–∫ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤ –ø–∞–¥–∞–µ—Ç 3 –≥–æ–¥–∞ (-0.9% –¥–æ -6%)
- –ü—Ä–∏—á–∏–Ω—ã: De Beers, —Ç–∞—Ä–∏—Ñ—ã –°–®–ê
- –¢—Ä–µ–Ω–¥: —Ä–æ—Å—Ç —Å–ø—Ä–æ—Å–∞ –Ω–∞ –∫—Ä—É–ø–Ω—ã–µ –∫–∞–º–Ω–∏
[–ò—Å—Ç–æ—á–Ω–∏–∫: @banksta, 2025-10-11]
```

---

## üí° –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –î–∞–π–¥–∂–µ—Å—Ç –∫–æ–≥–¥–∞:

‚úÖ –ù—É–∂–µ–Ω **–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫** –ø–æ—Å—Ç–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥  
‚úÖ –ù—É–∂–Ω–æ **–ø—Ä–æ–ª–∏—Å—Ç–∞—Ç—å –≤—Å–µ** –ø–æ—Å—Ç—ã  
‚úÖ –í–∞–∂–Ω–∞ **—Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è** —Å–æ–±—ã—Ç–∏–π  
‚úÖ –ù—É–∂–Ω—ã **—Å—Å—ã–ª–∫–∏** –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –ø–æ—Å—Ç—ã  
‚úÖ –•–æ—Ç–∏—Ç–µ —É–≤–∏–¥–µ—Ç—å **–≤—Å–µ –∫–∞–Ω–∞–ª—ã** —Å—Ä–∞–∑—É  
‚úÖ –ù—É–∂–µ–Ω **–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π/–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ–±–∑–æ—Ä**  

**–ü—Ä–∏–º–µ—Ä—ã:**
- "–ß—Ç–æ –±—ã–ª–æ —Å–µ–≥–æ–¥–Ω—è?"
- "–ü–æ–∫–∞–∂–∏ –≤—Å–µ –ø–æ—Å—Ç—ã –∑–∞ –Ω–µ–¥–µ–ª—é"
- "–î–∞–π —Å–≤–æ–¥–∫—É –ø–æ –≤—Å–µ–º –∫–∞–Ω–∞–ª–∞–º"

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RAG-–æ—Ç–≤–µ—Ç –∫–æ–≥–¥–∞:

‚úÖ –ù—É–∂–µ–Ω **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç** –Ω–∞ –≤–æ–ø—Ä–æ—Å  
‚úÖ –í–∞–∂–µ–Ω **–∞–Ω–∞–ª–∏–∑** –∏ **–≤—ã–≤–æ–¥—ã**  
‚úÖ –ù—É–∂–Ω–∞ **—Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è** –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞  
‚úÖ –•–æ—Ç–∏—Ç–µ –ø–æ–Ω—è—Ç—å **—Ç—Ä–µ–Ω–¥—ã** –∏–ª–∏ **–∏–∑–º–µ–Ω–µ–Ω–∏—è**  
‚úÖ –ù—É–∂–Ω–∞ **–¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è** –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–µ–º—ã  

**–ü—Ä–∏–º–µ—Ä—ã:**
- "–ß—Ç–æ –ø–∏—Å–∞–ª–∏ –ø—Ä–æ –±—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã?"
- "–ö–∞–∫–∏–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –Ω–∞ –∫—Ä–∏–ø—Ç–æ—Ä—ã–Ω–∫–µ?"
- "–ü–æ—á–µ–º—É —É–ø–∞–ª–∏ —Ü–µ–Ω—ã?"

---

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (TODO)

### –í–æ–∑–º–æ–∂–Ω—ã–µ AI-—Ñ–∏—á–∏ –¥–ª—è –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤:

**1. AI-—Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```python
# –í–º–µ—Å—Ç–æ –ø–µ—Ä–≤—ã—Ö 300 —Å–∏–º–≤–æ–ª–æ–≤
summary = await generate_summary(post.text)  # GigaChat
```

**2. –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–∫—Ç–æ–≤**
```python
# –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞
key_facts = await extract_key_facts(post.text)  # GigaChat
```

**3. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ —Ç–µ–º–∞–º**
```markdown
## üìä –§–∏–Ω–∞–Ω—Å—ã (8 –ø–æ—Å—Ç–æ–≤)
- –ë—Ä–∏–ª–ª–∏–∞–Ω—Ç—ã: –ø–∞–¥–µ–Ω–∏–µ —Ü–µ–Ω
- –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã: –æ–±–≤–∞–ª —Ä—ã–Ω–∫–∞
- ...

## üåç –ì–µ–æ–ø–æ–ª–∏—Ç–∏–∫–∞ (4 –ø–æ—Å—Ç–∞)
- –¢–æ—Ä–≥–æ–≤—ã–π —Ñ–ª–æ—Ç
- ...
```

**4. –¢—Ä–µ–Ω–¥-–∞–Ω–∞–ª–∏–∑**
```markdown
## üìà –¢—Ä–µ–Ω–¥—ã –¥–Ω—è:
1. ‚¨áÔ∏è –ü–∞–¥–µ–Ω–∏–µ —Ü–µ–Ω –Ω–∞ –∞–ª–º–∞–∑—ã
2. üî¥ –û–±–≤–∞–ª –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç (-57% –¥–æ -99%)
3. üö¢ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–∏—Ä–æ–≤–æ–º —Ñ–ª–æ—Ç–µ
```

**5. –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ (executive summary)**
```markdown
## üíº –ì–ª–∞–≤–Ω–æ–µ –∑–∞ –¥–µ–Ω—å:
- –†—ã–Ω–æ–∫ –∞–ª–º–∞–∑–æ–≤ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–∞–¥–∞—Ç—å (3-–π –≥–æ–¥)
- –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –æ–±–≤–∞–ª–∏–ª–∏—Å—å –Ω–∞ 57-99%
- –ò–Ω–¥–æ–Ω–µ–∑–∏—è - –∫—Ä—É–ø–Ω–µ–π—à–∏–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ñ–ª–æ—Ç
```

---

## üîß –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å AI-—Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å—Ç–∞

```python
async def _summarize_post(self, post: Post) -> str:
    """–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –ø–æ—Å—Ç–∞"""
    prompt = f"""
    –°–æ–∫—Ä–∞—Ç–∏ —ç—Ç–æ—Ç –ø–æ—Å—Ç –¥–æ 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π, 
    –≤—ã–¥–µ–ª–∏–≤ —Ç–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç—ã:
    
    {post.text}
    """
    
    summary = await self.rag_generator._call_llm(
        messages=[{"role": "user", "content": prompt}],
        temperature=0.3
    )
    
    return summary
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±—â–∞—è —Å–≤–æ–¥–∫–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞

```python
async def _generate_executive_summary(
    self, 
    posts: List[Post]
) -> str:
    """–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤"""
    
    # –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ç–µ–∫—Å—Ç—ã
    all_texts = "\n\n".join([f"- {p.text[:200]}" for p in posts[:20]])
    
    prompt = f"""
    –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –ø–æ—Å—Ç–æ–≤ —Å–æ–∑–¥–∞–π –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É (3-5 –ø—É–Ω–∫—Ç–æ–≤) 
    —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ —Ç—Ä–µ–Ω–¥–∞–º–∏:
    
    {all_texts}
    """
    
    summary = await self.rag_generator._call_llm(
        messages=[{"role": "user", "content": prompt}],
        temperature=0.3
    )
    
    return summary
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –¥–∞–π–¥–∂–µ—Å—Ç

```python
# –í _generate_markdown_digest():
lines.append(f"# üì∞ –î–∞–π–¥–∂–µ—Å—Ç –ø–æ—Å—Ç–æ–≤")
lines.append(f"**–ü–µ—Ä–∏–æ–¥:** {date_from} - {date_to}")

# –î–æ–±–∞–≤–∏—Ç—å AI-—Å–≤–æ–¥–∫—É
if use_ai_summary:
    summary = await self._generate_executive_summary(all_posts)
    lines.append("\n## üíº –ì–ª–∞–≤–Ω–æ–µ –∑–∞ –ø–µ—Ä–∏–æ–¥:")
    lines.append(summary)
    lines.append("")

lines.append("## üìã –í—Å–µ –ø–æ—Å—Ç—ã:")
# ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
```

---

## üìö API –ø—Ä–∏–º–µ—Ä—ã

### –¢–µ–∫—É—â–∏–π –¥–∞–π–¥–∂–µ—Å—Ç (–±–µ–∑ AI)

```bash
curl -X POST "http://localhost:8020/rag/digest/generate" \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": 6,
    "date_from": "2025-10-11T00:00:00Z",
    "date_to": "2025-10-11T23:59:59Z",
    "format": "markdown",
    "max_posts": 200
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤

### –ë—É–¥—É—â–∏–π AI-–¥–∞–π–¥–∂–µ—Å—Ç (TODO)

```bash
curl -X POST "http://localhost:8020/rag/digest/generate" \
  -d '{
    "user_id": 6,
    "date_from": "2025-10-11T00:00:00Z",
    "date_to": "2025-10-11T23:59:59Z",
    "ai_summarize": true,          # ‚Üê –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
    "ai_cluster": true,            # ‚Üê –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ —Ç–µ–º–∞–º
    "executive_summary": true      # ‚Üê –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** AI-–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç —Å –∞–Ω–∞–ª–∏–∑–æ–º

---

## ‚úÖ –ò—Ç–æ–≥

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

```
–î–∞–π–¥–∂–µ—Å—Ç = –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ (–ë–ï–ó AI)
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ë—ã—Å—Ç—Ä–æ (–Ω–µ—Ç –≤—ã–∑–æ–≤–æ–≤ LLM)
- ‚úÖ –î–µ—à–µ–≤–æ (–Ω–µ—Ç API calls)
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ (–Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç AI)
- ‚úÖ –ü–æ–ª–Ω–æ—Ç–∞ (–≤—Å–µ –ø–æ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è)

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ (–¥–ª–∏–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã = –¥–ª–∏–Ω–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç)
- ‚ùå –ù–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ (–Ω–µ –≤–∏–¥–Ω—ã —Ç—Ä–µ–Ω–¥—ã)
- ‚ùå –ù–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–∏ (–≤—Å–µ –ø–æ—Å—Ç—ã —Ä–∞–≤–Ω—ã)
- ‚ùå –ú–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è (200 –ø–æ—Å—Ç–æ–≤ √ó 300 —Å–∏–º–≤–æ–ª–æ–≤)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–î–ª—è 200+ –ø–æ—Å—Ç–æ–≤ –≤ –¥–µ–Ω—å:**
- –¢–µ–∫—É—â–∏–π –¥–∞–π–¥–∂–µ—Å—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å **—Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–º**
- –°—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å **AI-—Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é** (–æ–ø—Ü–∏—è)
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **RAG-–æ—Ç–≤–µ—Ç** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:
  ```bash
  # –í–º–µ—Å—Ç–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞
  curl -X POST "http://localhost:8020/rag/ask" \
    -d '{"query": "–ì–ª–∞–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∑–∞ —Å–µ–≥–æ–¥–Ω—è?", "user_id": 6}'
  ```

---

**–§–∞–π–ª:** `digest_generator.py`  
**–ú–æ–¥–µ–ª—å:** –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–ø—Ä–æ—Å—Ç–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)  
**–î–∞—Ç–∞:** 11 –æ–∫—Ç—è–±—Ä—è 2025

