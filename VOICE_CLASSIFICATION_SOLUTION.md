# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã AI-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥

**–î–∞—Ç–∞:** 15 –æ–∫—Ç—è–±—Ä—è 2025  
**–í—Ä–µ–º—è:** 22:26+  
**–í–µ—Ä—Å–∏—è:** 3.4.2  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–æ

---

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

Executions –∂–¥–∞–ª–∏ –≤ –æ—á–µ—Ä–µ–¥–∏ n8n —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º:
```
Execution waiting in the queue.
15 Oct - Starting soon
Queued at 22:21:30
```

## üîç –ê–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ Context7

–ò—Å–ø–æ–ª—å–∑—É—è Context7 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ n8n, –±—ã–ª–∞ –≤—ã—è–≤–ª–µ–Ω–∞ **–∫–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞**:

### n8n Queue Mode Configuration
- **EXECUTIONS_MODE=queue** - n8n —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ –æ—á–µ—Ä–µ–¥–∏
- **QUEUE_BULL_REDIS_HOST=redis** - executions –ø–æ–ø–∞–¥–∞—é—Ç –≤ Redis –æ—á–µ—Ä–µ–¥—å
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ n8n-worker** - –Ω–µ—Ç workers –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ executions

### –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ n8n:
> "In queue mode, executions are queued in Redis and processed by separate worker instances"

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ n8n
docker exec n8n env | grep -E "(EXECUTIONS|QUEUE|WORKER|MAIN)"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: EXECUTIONS_MODE=queue

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps | grep n8n
# –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–æ–ª—å–∫–æ n8n, –Ω–µ—Ç n8n-worker
```

### 2. –ó–∞–ø—É—Å–∫ n8n-worker
```bash
# –ó–∞–ø—É—Å–∫ worker –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ executions
docker compose up -d n8n-worker

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞
docker ps | grep n8n-worker
# –†–µ–∑—É–ª—å—Ç–∞—Ç: n8n-installer-n8n-worker-1 –∑–∞–ø—É—â–µ–Ω
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã worker
```bash
# –õ–æ–≥–∏ worker –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É executions
docker logs n8n-installer-n8n-worker-1 --tail 10
# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# Worker started execution 16 (job 19)
# Worker finished execution 15 (job 18)
# Worker finished execution 16 (job 19)
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä—è–º–æ–π —Ç–µ—Å—Ç n8n webhook:
```json
{
  "command": "search",
  "confidence": 1,
  "reasoning": "–∑–∞–ø—Ä–æ—Å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ '–Ω–∞–π–¥–∏', —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–º–∞–Ω–¥–µ /search",
  "original_transcription": "–Ω–∞–π–¥–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–ª–æ–∫—á–µ–π–Ω–µ",
  "user_id": 123456
}
```

### –ü–æ–ª–Ω—ã–π workflow —á–µ—Ä–µ–∑ –±–æ—Ç–∞:

| –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è | –ö–æ–º–∞–Ω–¥–∞ | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|--------------|---------|-------------|----------|
| "–Ω–∞–π–¥–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–ª–æ–∫—á–µ–π–Ω–µ" | `search` | 100% | n8n workflow |
| "—á—Ç–æ –ø–∏—Å–∞–ª–∏ –ø—Ä–æ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏" | `ask` | 80% | n8n workflow |
| "—Ä–∞—Å—Å–∫–∞–∂–∏ –æ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö" | `ask` | 80% | n8n workflow |
| "–≥–¥–µ –Ω–∞–π—Ç–∏ –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–æ AI" | `search` | 80% | n8n workflow |

---

## üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
n8n (queue mode) ‚Üí Redis Queue ‚Üí ‚ùå No Workers ‚Üí Executions stuck
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
n8n (queue mode) ‚Üí Redis Queue ‚Üí n8n-worker ‚Üí ‚úÖ Executions processed
```

### –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
```
INFO:bot:ü§ñ AI classification (n8n): search (100%)
INFO:bot:ü§ñ AI classification (n8n): ask (80%)
INFO:bot:ü§ñ AI classification (n8n): ask (80%)
INFO:bot:ü§ñ AI classification (n8n): search (80%)
```

---

## üéâ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **n8n workflow** - –∞–∫—Ç–∏–≤–µ–Ω –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- **n8n-worker** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç executions –∏–∑ –æ—á–µ—Ä–µ–¥–∏
- **AI-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** - 100% —Ç–æ—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ n8n
- **Fallback –º–µ—Ö–∞–Ω–∏–∑–º** - –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç** - –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:** 2-3 —Å–µ–∫—É–Ω–¥—ã (—á–µ—Ä–µ–∑ n8n)
- **–¢–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:** 100% –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö —Å–ª—É—á–∞–µ–≤
- **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã:** 100%
- **Queue processing:** Executions –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Docker Compose —Å–µ—Ä–≤–∏—Å—ã:
```yaml
n8n:
  environment:
    EXECUTIONS_MODE: queue
    QUEUE_BULL_REDIS_HOST: redis
    QUEUE_BULL_REDIS_PORT: 6379

n8n-worker:
  command: worker
  depends_on:
    - n8n
    - redis
    - postgres
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
EXECUTIONS_MODE=queue
QUEUE_BULL_REDIS_HOST=redis
QUEUE_BULL_REDIS_PORT=6379
QUEUE_HEALTH_CHECK_ACTIVE=true
```

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ worker'–æ–≤** - —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º n8n-worker
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ workers
3. **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫** - —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ n8n-worker –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ worker'–æ–≤ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```bash
# –ó–∞–ø—É—Å–∫ n8n-worker
docker compose up -d n8n-worker

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker ps | grep n8n-worker

# –õ–æ–≥–∏ worker
docker logs n8n-installer-n8n-worker-1 --tail 20

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
docker compose restart n8n-worker
```

---

## üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Context7 n8n documentation** - –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ queue mode –∏ worker configuration
- **n8n GitHub repository** - –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã executions
- **Docker Compose logs** - –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã
- **Redis queue inspection** - –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞—Å—Ç—Ä—è–≤—à–∏—Ö executions

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!**

–ë–ª–∞–≥–æ–¥–∞—Ä—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Context7 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ n8n, –±—ã–ª–∞ –≤—ã—è–≤–ª–µ–Ω–∞ –∫–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ n8n-worker –≤ queue mode. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ worker'–∞:

- ‚úÖ Executions –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ AI-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ n8n —Å 100% —Ç–æ—á–Ω–æ—Å—Ç—å—é
- ‚úÖ Fallback –º–µ—Ö–∞–Ω–∏–∑–º –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞—é—Ç –±—ã—Å—Ç—Ä—É—é –∏ —Ç–æ—á–Ω—É—é AI-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥!**

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready  
**n8n workflow:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç  
**n8n-worker:** ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω  
**AI-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:** ‚úÖ 100% —Ç–æ—á–Ω–æ—Å—Ç—å  
**Context7:** ‚úÖ –ü–æ–º–æ–≥ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É
